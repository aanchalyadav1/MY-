<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Upload â€” Admin</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="top-right-menu"><a href="admin.html" class="trm-item">Admin</a></nav>
  <main class="container">
    <h1>Upload File</h1>
    <div class="card">
      <input type="file" id="fileInput" />
      <div style="margin-top:10px">
        <button id="uploadBtn" class="btn">Upload to Storage</button>
      </div>
    </div>
    <div id="result"></div>
  </main>
  <div id="toasts" class="toasts"></div>

  <script src="firebase.js" defer></script>
  <script src="global.js" defer></script>
  <script>
    (function(){
      const storage = window.storage;
      const fileInput = document.getElementById('fileInput');
      const uploadBtn = document.getElementById('uploadBtn');
      const result = document.getElementById('result');
      uploadBtn.addEventListener('click', async () => {
        const f = fileInput.files[0];
        if(!f){ toast('Select a file', {type:'error'}); return; }
        const name = Date.now() + '_' + f.name.replace(/\s+/g,'_');
        const ref = storage.ref().child('uploads/' + name);
        toast('Uploading...');
        try{
          await ref.put(f);
          const url = await ref.getDownloadURL();
          result.innerHTML = `<p>Uploaded: <a href="${url}" target="_blank">Open</a></p>`;
          toast('Upload complete');
        }catch(e){ console.error(e); toast('Upload failed', {type:'error'}); }
      });
    })();
  </script>
</body>
</html>
